<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">        <style>
            body {
                font-family: Arial, sans-serif;
                margin: 0;
                padding: 0;
                background-color: #f4f4f4;
            }
            .main-content {
                padding: 20px;
                max-width: 1200px;
                margin: 0 auto;
            }
            h1 {
                color: #333;
                margin-top: 0;
            }
            h2 {
                color: #333;
            }
            .location-section {
                display: flex;
                align-items: flex-start;
                margin-bottom: 40px;
                background-color: white;
                padding: 15px;
                border-radius: 8px;
                box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            }
            .location-image {
                flex: 0 0 200px;
                margin-right: 20px;
                text-align: center;
            }
            .location-image img {
                width: 200px;
                height: 150px;
                object-fit: cover;
                border-radius: 5px;
            }
            .location-embed {
                margin-top: 10px;
                border-radius: 5px;
                overflow: hidden;
            }
            .aws-embed iframe {
                width: 500px;
                height: 400px;
                border: 0;
            }
            .aws-embed {
                margin-top: 10px;
                border-radius: 5px;
            }
            .location-embed iframe {
                width: 200px;
                height: 150px;
                border: 0;
            }
            .info-btn {
                background-color: #007bff;
                color: white;
                border: none;
                border-radius: 50%;
                width: 30px;
                height: 30px;
                margin-top: 10px;
                cursor: pointer;
                font-size: 16px;
                display: inline-block;
            }
            .info-btn:hover {
                background-color: #0056b3;
            }
            .info-panel {
                display: none;
                background-color: #e9ecef;
                border: 1px solid #dee2e6;
                border-radius: 5px;
                padding: 15px;
                margin-top: 10px;
                font-size: 14px;
                line-height: 1.5;
            }
            .info-panel.show {
                display: block;
            }
            .location-content {
                flex: 1;
                display: flex;
                flex-direction: column;
            }
            .data-section {
                display: flex;
                gap: 20px;
                margin-bottom: 10px;
            }
            .chart-wrapper {
                flex: 0 0 400px;
            }
            .chart-wrapper canvas {
                max-width: 100%;
                height: 200px !important;
            }
            .table-wrapper {
                flex: 1;
            }
            table {
                width: 100%;
                border-collapse: collapse;
                background-color: white;
            }
            th, td {
                border: 1px solid #ddd;
                padding: 8px;
                text-align: left;
            }
            th {
                background-color: #268171;
                color: white;
            }
            .total-accumulation {
                margin: 10px 0;
                font-weight: bold;
                color: #333;
            }
            .warning {
                padding: 10px;
                margin: 10px 0;
                border-radius: 5px;
                font-weight: bold;
            }
            .low { background-color: #F4F754; color: black; }
            .moderate { background-color: #E9B63B; color: black; }
            .high { background-color: #f8d7da; color: #721c24; }
            .loading {
                color: #666;
                font-style: italic;
            }
            .error {
                color: #721c24;
                background-color: #f8d7da;
                padding: 10px;
                border-radius: 5px;
            }
            @media (max-width: 768px) {
                .hamburger {
                    display: flex;
                }
                .data-section {
                    flex-direction: column;
                }
                .chart-wrapper {
                    flex: 1;
                    order: 2;
                }
                .table-wrapper {
                    order: 1;
                }
                .location-section {
                    flex-direction: column;
                    padding: 10px;
                }
                .location-image {
                    flex: none;
                    margin-right: 0;
                    margin-bottom: 15px;
                }
                .main-content {
                    padding: 10px;
                }
            }
        </style>
    </head>
    <body>

        <p><strong>Rainfall-Landslide Threshold:</strong></p>

            <p><strong>Benguet</strong>: 64 mm*</p>


        <button class="refresh-btn" onclick="refreshAllData()">Refresh Data</button>

        <div id="mankayan" class="location-section">
            <div class="location-image">
                <img src="https://ligtas.uplb.edu.ph/wp-content/uploads/2022/04/Mankayan-AWS.jpg" alt=" LIGTAS Mankayan AWS" />
                <div class="location-embed">
                    <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d216.00355871790734!2d120.81777286857782!3d16.823020211977497!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x3391d300295794b5%3A0xf825ed3e639269a5!2sTawid%20Museum!5e1!3m2!1sen!2sph!4v1759478026283!5m2!1sen!2sph" width="600" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                </div>
                <button class="info-btn" onclick="toggleInfo('mankayan-info')">ℹ️</button>
                <div id="mankayan-info" class="info-panel">
                    <ul>
                        <p><strong>12 barangays covered:</strong></p>
                        <li>Guinaoang</li>
                        <li>Bedbed</li>
                        <li>Bulalacao</li>
                        <li>Cabiten</li>
                        <li>Colalo</li>
                        <li>Balili</li>
                        <li>Paco</li>
                        <li>Palasaan</li>
                        <li>Poblacion</li>
                        <li>Sapid</li>
                        <li>Tabio</li>
                        <li>Taneg</li>
                    </ul>
                </div>
            </div>
            <div class="location-content">
                <h2>LIGTAS-AWS: Mankayan, Benguet (Brgy.Guinaoang: 16.82303° N, 120.8179° E)</h2>
                <div id="mankayan-table" class="loading">Loading data...</div>
                <div id="mankayan-warning"></div>
            </div>
            <div class="aws-embed">
                <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d216.00355871790734!2d120.81777286857782!3d16.823020211977497!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x3391d300295794b5%3A0xf825ed3e639269a5!2sTawid%20Museum!5e1!3m2!1sen!2sph!4v1759478026283!5m2!1sen!2sph" width="600" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
            </div>
        </div>

        <div id="buguias" class="location-section">
            <div class="location-image">
                <img src="https://ligtas.uplb.edu.ph/wp-content/uploads/2025/08/1755019865595.jpg" alt="LIGTAS Buguias AWS" />
                <div class="location-embed">
                    <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d432.08569887464733!2d120.8322804658861!3d16.78851652684388!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x3391cd93f8aedc45%3A0xbe93a4e969c4bcc!2sBenguet%20State%20University%2C%20Buguias%20Campus%2C%20Loo%20Valley!5e1!3m2!1sen!2sph!4v1759721436267!5m2!1sen!2sph" width="600" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                </div>
                <button class="info-btn" onclick="toggleInfo('buguias-info')">ℹ️</button>
                <div id="buguias-info" class="info-panel">
                    <ul>
                        <p><strong>barangays covered:</strong></p>
                        <li>-</li>
                        <li>-</li>
                        <li>-</li>
                        <li>-</li>
                        <li>-</li>
                        <li>-</li>
                        <li>-</li>
                        <li>-</li>
                        <li>-</li>
                        <li>-</li>
                        <li>-</li>
                        <li>-</li>
                    </ul>
                </div>
            </div>
            <div class="location-content">
                <h2>LIGTAS-AWS: Buguias, Benguet (Brgy.Loo: 16.7884° N, 120.8328° E)</h2>
                <div id="buguias-table" class="loading">Loading data...</div>
                <div id="buguias-warning"></div>
            </div>
            <div class="aws-embed">
                <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d432.08569887464733!2d120.8322804658861!3d16.78851652684388!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x3391cd93f8aedc45%3A0xbe93a4e969c4bcc!2sBenguet%20State%20University%2C%20Buguias%20Campus%2C%20Loo%20Valley!5e1!3m2!1sen!2sph!4v1759721436267!5m2!1sen!2sph" width="600" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
            </div>
        </div>

        <div id="tublay" class="location-section">
            <div class="location-image">
                <img src="https://ligtas.uplb.edu.ph/wp-content/uploads/2025/10/Tublay-AWS-updated.jpg" alt="LIGTAS Tublay AWS" />
                <div class="location-embed">
                    <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d216.3942330036886!2d120.65964342937593!3d16.47682463033387!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x3391a50b70757993%3A0x40a81ad3c8f77e!2sDorencio%20Elementary%20School!5e1!3m2!1sen!2sph!4v1759478664071!5m2!1sen!2sph" width="600" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                </div>
                <button class="info-btn" onclick="toggleInfo('tublay-info')">ℹ️</button>
                <div id="tublay-info" class="info-panel">
                    <ul>
                        <p><strong>barangays covered:</strong></p>
                        <li>-</li>
                        <li>-</li>
                        <li>-</li>
                        <li>-</li>
                        <li>-</li>
                        <li>-</li>
                        <li>-</li>
                        <li>-</li>
                        <li>-</li>
                        <li>-</li>
                        <li>-</li>
                        <li>-</li>
                    </ul>
                </div>
            </div>
            <div class="location-content">
                <h2>LIGTAS-AWS: Tublay, Benguet (Brgy. Ambassador: 16.47686° N, 120.6598° E)</h2>
                <div id="tublay-table" class="loading">Loading data...</div>
                <div id="tublay-warning"></div>
            </div>
        </div>

        <div id="itogon" class="location-section">
            <div class="location-image">
                <img src="https://ligtas.uplb.edu.ph/wp-content/uploads/2025/10/Itogon-Benguet-Automatic-Weather-Station-AWS-.jpg" alt="LIGTAS Itogon AWS" />
                <div class="location-embed">
                    <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d364.07150046074764!2d120.64659089183121!3d16.401481923246095!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x3391a7c6e2289949%3A0x8eb902c3388a07e6!2sAlejo%20M.%20Pacalso%20Memorial%20National%20High%20School!5e1!3m2!1sen!2sph!4v1759731577796!5m2!1sen!2sph" width="600" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                </div>
                <button class="info-btn" onclick="toggleInfo('itogon-info')">ℹ️</button>
                <div id="itogon-info" class="info-panel">
                    <ul>
                        <p><strong>barangays covered:</strong></p>
                        <li>-</li>
                        <li>-</li>
                        <li>-</li>
                        <li>-</li>
                        <li>-</li>
                        <li>-</li>
                        <li>-</li>
                        <li>-</li>
                        <li>-</li>
                        <li>-</li>
                        <li>-</li>
                        <li>-</li>
                    </ul>
                </div>
            </div>
            <div class="location-content">
                <h2>LIGTAS-AWS: Itogon, Benguet (Alejo Pacalso: 16.4017° N, 120.6465
                    ° E)</h2>
                <div id="itogon-table" class="loading">Loading data...</div>
                <div id="itogon-warning"></div>
            </div>
        </div>

        <script>
            // Configuration
            const locations = [
                { id: 'mankayan', lat: 16.8230, lon: 120.8179, name: 'Mankayan' },
                { id: 'buguias', lat: 16.7884, lon: 120.8328, name: 'Buguias' },
                { id: 'tublay', lat: 16.4768, lon: 120.6598, name: 'Tublay' },
                { id: 'itogon', lat: 16.4017, lon: 120.6465, name: 'Itogon' }
            ];

            // Use Open-Meteo free API for historical precipitation (no key needed)
            async function fetchRainfall(lat, lon) {
                const today = new Date();
                const endDate = today.toISOString().split('T')[0];
                const startDate = new Date(today.getTime() - 7 * 24 * 60 * 60 * 1000).toISOString().split('T')[0]; // 8 days to get 7 full days
                const url = `https://archive-api.open-meteo.com/v1/archive?latitude=${lat}&longitude=${lon}&start_date=${startDate}&end_date=${endDate}&daily=precipitation_sum&timezone=Asia/Manila`;

                try {
                    const response = await fetch(url);
                    if (!response.ok) throw new Error('API request failed');
                    const data = await response.json();
                    const dailyData = data.daily;
                    const rainfallData = [];
                    for (let i = 1; i < dailyData.time.length; i++) { // Skip first day if partial
                        rainfallData.push({
                            date: dailyData.time[i],
                            precip: dailyData.precipitation_sum[i] || 0
                        });
                    }
                    return rainfallData.slice(0, 7); // Ensure exactly 7 days
                } catch (error) {
                    console.error('Error fetching rainfall data:', error);
                    // Fallback mock data
                }
            }

            function computeTotalAndWarning(rainfallData) {
                const total = rainfallData.reduce((sum, day) => sum + day.precip, 0);
                let warningLevel, message;
                if (total <= 7.5) {
                    warningLevel = 'low';
                    message = `Low Landslide Hazard: Total accumulation ${total.toFixed(1)} mm. No immediate concern.`;
                } else if (total <= 48) {
                    warningLevel = 'moderate';
                    message = `Moderate Landslide Hazard: Total accumulation ${total.toFixed(1)} mm. Monitor slopes and avoid risky areas.`;
                } else {
                    warningLevel = 'high';
                    message = `High Landslide Hazard: Total accumulation ${total.toFixed(1)} mm. Evacuate vulnerable areas and seek safety.`;
                }
                return { total, warningLevel, message };
            }

            function displayTable(containerId, rainfallData) {
                const container = document.getElementById(containerId + '-table');
                if (rainfallData.length === 0) {
                    container.innerHTML = '<p class="error">No data available.</p>';
                    return;
                }
                let tableHTML = `
<table>
<thead>
<tr>
<th>Date</th>
<th>Daily Rainfall (mm)</th>
            </tr>
            </thead>
<tbody>
`;
                rainfallData.forEach(day => {
                    tableHTML += `
<tr>
<td>${day.date}</td>
<td>${day.precip.toFixed(1)}</td>
            </tr>
`;
                });
                tableHTML += `
            </tbody>
            </table>
<p><strong>Total 7-Day Accumulation: ${rainfallData.reduce((sum, day) => sum + day.precip, 0).toFixed(1)} mm</strong></p>
`;
                container.innerHTML = tableHTML;
            }

            function displayWarning(containerId, warning) {
                const container = document.getElementById(containerId + '-warning');
                container.innerHTML = `<div class="warning ${warning.warningLevel}">${warning.message}</div>`;
            }

            async function loadLocation(location) {
                const rainfallData = await fetchRainfall(location.lat, location.lon);
                displayTable(location.id, rainfallData);
                const { total, warningLevel, message } = computeTotalAndWarning(rainfallData);
                displayWarning(location.id, { warningLevel, message });
            }

            // Load data for all locations on page load
            document.addEventListener('DOMContentLoaded', () => {
                locations.forEach(loadLocation);
            });

            // Refresh function
            function refreshAllData() {
                locations.forEach(loadLocation);
            }

            // Toggle info panel function
            function toggleInfo(infoId) {
                const panel = document.getElementById(infoId);
                if (panel) {
                    panel.classList.toggle('show');
                }
            }
        </script>
    </body>
</html>

